# 오늘 할 일

- [x] 부족한 지식 채우기

---

# 오늘 한 일 (회고)

- 브라우저의 렌더링 과정에 대한 상세한 것들을 찾아봤다. 지금까지 추상적으로만 알고 있었던 것 같아 충분한 이해가 필요하다고 느꼈다. 물론, 아직까지 실제로 브라우저가 네트워크 통신을 통해 렌더링에 필요한 파일들을 받아오는 과정에 대해서 완벽하게 이해하지는 못한 것 같아 네트워크에 대한 공부가 필요하다고 느껴진다. 내일은 아래 공부한 내용들을 다시 한 번 정리해야겠다.

  - 사용자가 주소창에 주소를 입력 후 특정 페이지에 접속하면 일어나는 과정
    1. 사용자가 브라우저에 도메인 네임([www.abcd.com)을](http://www.naver.xn--com%29-8040a/) 입력한다.
    2. 사용자가 입력한 URL 주소 중에서 도메인 네임(Domain Name) 부분을 DNS 서버에서 검색하고, DNS 서버에서 해당 도메인 네임에 해당하는 IP 주소를 찾아 사용자가 입력한 URL 정보와 함께 전달한다.
    3. 페이지 URL 정보와 전달받은 IP 주소는 HTTP 프로토콜을 사용하여 HTTP 요청 메시지를 생성하고, 이렇게 생성된 HTTP 요청 메시지는 TCP 프로토콜을 사용하여 인터넷을 거쳐 해당 IP 주소의 컴퓨터로 전송된다.
    4. 이렇게 도착한 HTTP 요청 메시지는 HTTP 프로토콜을 사용하여 웹 페이지 URL 정보로 변환되어 웹 페이지 URL 정보에 해당하는 데이터를 검색한다.
    5. 검색된 웹 페이지 데이터는 또 다시 HTTP 프로토콜을 사용하여 HTTP 응답 메시지를 생성하고 TCP 프로토콜을 사용하여 인터넷을 거쳐 원래 컴퓨터로 전송된다.
    6. 도착한 HTTP 응답 메시지는 HTTP 프로토콜을 사용하여 웹 페이지 데이터로 변환되어 웹 브라우저에 의해 출력되어 사용자가 볼 수 있게 된다.
  - 브라우저의 렌더링 과정

    1. DOM 트리 구축 및 CSSOM 트리 구축: 브라우저는 렌더링 할 문서를 HTML과 CSS로 나눠서 읽는다. 이 때 HTML과 CSS는 단순한 텍스트이므로 각각 연산과 관리가 가능하도록 HTML/CSS Parser를 이용해 관리가 가능한 Object Model로 만든다.
    2. 렌더 트리 구축: 이전 단계에서 생성된 DOM 트리와 CSSOM 트리를 연결해 Render Tree를 생성한다. 요소들의 구조와 텍스트만 존재하는 DOM 트리와는 달리 Render Tree에는 스타일 정보가 설정되어 있으며 실제 화면에 표현되는 노드들로만 구성된다. (예를 들어, `display:none` 속성이 설정된 노드는 Render Tree에서 제외됨)
    3. Layout: 브라우저의 뷰포트 내에서 각 노드들이 가지고 있는 스타일과 속성에 따라 브라우저 화면의 어느 위치에 어떤 크기로 출력될지 계산하는 단계로, %, vh, vw와 같은 상대적인 위치와 크기 속성들은 실제 화면에 그려지는 pixel 단위로 변환된다.
    4. Paint: 레이아웃 계산이 완료된 후, 실제 화면에 요소들을 그리는 단계. 스타일 계산이 완료된 렌더 트리를 이용해 브라우저는 요소들을 실제 화면에 그리게 된다.

    뷰포트란, 그래픽이 표시되는 브라우저의 영역을 말하며 모바일의 경우 디스플레이의 크기, PC의 경우 브라우저의 창의 크기에 따라 달라진다. 이 때, 화면에 그려지는 요소들의 크기와 위치는 %, vh, vw와 같이 상대적으로 계산하여 그려지는 경우가 많기 때문에 뷰포트 크기가 달라질 경우 매번 계산을 다시해야 한다.

- 렌더링 최적화 (Reflow, Repaint)
  - 위에 언급한 렌더링 과정들은 페이지가 처음 그려지는 과정이며, 사용자와의 인터랙션으로 인해 html 요소의 크기나 위치 등의 레이아웃 수치가 변경되면 그에 영향을 받는 자식 노드나 부모 노드들을 포함하여 Layout 과정을 다시 수행하게 된다. 이렇게 되면 Render Tree와 각 요소들의 크기와 위치를 다시 계산해야 하는데, 이러한 과정을 **Reflow**라고 한다.
  - 실제로 Reflow가 발생되는 대표적인 경우는 다음과 같다.
    - 페이지 초기 렌더링 시 (최초 Layout 과정)
    - 윈도우 리사이징 시 (뷰포트 크기 변경)
    - 노드의 추가 및 제거
    - 요소의 위치 및 크기 변경 (left, top, margin, padding, border, width, height 등)
    - 폰트 변경
    - 이미지 변경 등
  - Reflow가 수행되는 것이 실제 화면에 반영되는 것은 아니다. 위에 언급한 렌더링 과정과 같이 Render Tree를 다시 화면에 그려주는 과정이 필요한데, 이것을 Repaint라고 한다. 무조건 Reflow - Repaint의 순서로 일어나는 것은 아니며, `background-color`, `visibility`와 같이 레이아웃에 영향을 주지 않는 스타일 속성이 변경된 경우엔 Reflow 없이 Repaint가 발생한다.
  - Reflow와 Repaint를 줄이기 위해서, 1. 사용하지 않는 요소에 `display: none` 속성을 사용하고, 2. Reflow 및 Repain가 발생하는 속성의 사용을 피하고, 3. 주변 요소에 영향을 주는 요소를 줄이고, 4. 프레임을 줄이는 방법 등이 있다.
- 지금까지는 학습의 우선순위를 프론트엔드 개발과 관련된 것에만 두고 있었던 것 같다. 물론 운영체제, 네트워크, 컴퓨터 구조 등 CS 지식들이 필요하다는 것은 알고 있었지만 우선순위를 뒤에 두고 스스로 합리화하며 학습을 게을리 해왔던 것 같다. 하지만, 실제로 협업을 진행하다 보면 자바스크립트나 리액트 등 프론트엔드 분야에 국한된 용어로만 대화를 하는 것이 아닌, 컴퓨터 하드웨어나 네트워크와 관련된 용어들을 사용해서 의사소통을 할 일이 필연적으로 생긴다는 것을 깨닫게 되었다. '좋은 개발자'란, 단순히 구현만 잘하는 개발자가 아니라 개발자들끼리의 의사소통에 무리가 없어야 한다고 생각한다. 그리고, 이러한 개발자가 되기 위해 앞으로 부족한 부분들에 대하여 꾸준히 학습을 이어나가야 할 것 같다.
